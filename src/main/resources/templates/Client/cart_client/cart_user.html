<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{/Client/index::dynamic(~{::main})}">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <link rel="stylesheet" href="../../../static/Client/css/cart_user.css">
    <link rel="stylesheet" href="../../../static/Client/css/_index.css">
    <link rel="stylesheet" href="../../../static/Client/css/product.css">
    <script th:src="@{/Client/Js/cart/cart.js}"></script>
    <script src="../../../static/Client/Js/cart/cart.js"></script>
</head>
</head>

<body>
    <main ng-app="cart_app" ng-controller="cart_ctrl">
        <div style="width: 85%; margin: auto; margin-top: 100px;" id="user1">
            <div class="mx-5" >
                <h4>Your Cart</h4>
                <div id="username">
                    <h1 th:text="${requestusername}"> </h1>
                </div>
            </div>
            <!-- sử dụng lặp shop -->
            <div th:each="l:${cartshoplist}" style="border: 1px solid #C93F04; border-radius: 10px; margin-top: 50px;">
                <div class="my-5" style="width: 90%; margin: auto;">
                    <div class="float-start">
                        <input type="checkbox"  class="form-check-input float-start mt-2" th:id="${l.shopid}" onclick="choose(id)"  name="inp">
                        <a href="#" style="text-decoration: none; color: #080808;"><span><i style="font-size: 30px;"
                                    class="bi bi-person-circle mx-3"></i></span>
                            <span style="font-size: 22px;" th:text= "${l.shopname}"></span></a>
                    </div>
                    <hr style="clear: both;">
                    <table class="table table-hover" id="table">
                        <thead>
                            <tr>
                                <th style="width: 5%;">
                                </th>
                                <th colspan="" style="width: 10%; "></th>
                                <th style="width: 30%;"> Product</th>
                                <th>Price</th>
                                <th style="width: 20%;">Quantity</th>
                                <th>Total</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="b:${cartuserList}" th:if="${b.books.shoponlines.shopid == l.shopid}">
                                <td>
                                    <input type="checkbox" value="${b.cartid}" onclick="selectOne(id)"  class="form-check-input"  th:id="${b.cartid}" name="carttest">
                                </td>
                                <td>
                                    <div>
                                        <img th:src="@{|/Client/images/${b.books.listOfImagebooks.get(0).name}|}" style="width: 50%;" alt="">
                                    </div>
                                </td>
                                <td ><a href="/book/detail?bookid = ${p.bookid}" th:text="${b.books.bookname}"></a></td>
                                <td th:text ="${#numbers.formatDecimal(b.books.price,0,'COMMA',2,'POINT')}"></td>
                                <td>
                                    <input type="number" th:attr="ng-change=@{|changequantity(${b.quantity},${b.cartid})|}" class="form-control" style="width: 100px;" min="1" step="1"  th:value ="${b.quantity}">
                                </td>
                                <td class="total_pro" th:text ="${#numbers.formatDecimal(b.books.price * b.quantity,0,'COMMA',2,'POINT')}"></td>
                                <td><a href="#" style="color: #000;"><i style="font-size: 30px;" class="bi bi-trash"></i></a></td>
                            </tr>
                        </tbody>
                    </table>
                    <hr style="clear: both; border: 1px solid black;">
                <div class="float-start m-3">
                    <input type="text" width="300px" class="form-control" placeholder="Tìm kiếm mã giảm" name="" id="">
                 </div>
                <div class="float-end m-3" ng-repeat="s in cartsvoucher.voucherAll">
                   <p style="font-size: 22px;">Giảm : <span style="color: #C93F04; font-weight: 500;"  ng-model="s.discountpercentage" ng-if="s.shopid ==  ${p.shopId}" id="voucher_sale"></span></p>
                </div>
                <div class="float-end m-3">
                    <select class="form-select" th:value="*{saleShopIntendFor}" th:attr="ng-change=@{|cartsvoucher.changevoucher(*{saleShopIntendFor})|}">
                        <option th:each="i : ${saleShopIntendFor}" th:if="${i.shopid == l.shopid}" th:value="${i.couoponcode}" th:text="${i.promotionname}"></option>
                    </select>
                </div>
                <hr style="clear: both; border: 2px solid black;">
                </div>
            </div>


            <div>
                <div style="width: 100%; height: 150px; margin-top: 50px; border-radius: 5px;" class="border-orange">
                    <div>
                        <div style="float: left; font-size: 25px; font-weight: 500; color: #333;  margin-top: 70px; margin-left: 50px;">
                            <button class="btn btn-success" id="selectAll">Select All</button>
                <button class="btn btn-danger" id="deleteAll" >Delete All</button>
                        </div>
                        <div style="float: right; font-size: 25px; font-weight: 500; color: #333;  margin-top: 50px;">
                           <form >
                            <p>
                                <span>Tổng tiền : <strong class="orange-text">{{$scope.totalAll}}</strong></span>
                                <span class="mx-5">
                                    <button  class="button_all_orange"  onclick="addetail()">Mua hàng</button>
                                </span>
                            </p>
                           </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script th:src="@{/Client/Js/cart/cart.js}"></script>
        <script src="../../../static/Client/Js/cart/cart.js"></script>
    </main>
</body>

</html>